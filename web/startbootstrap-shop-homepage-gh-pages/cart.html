<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ì¥ë°”êµ¬ë‹ˆ - Bonanza</title>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />

    <!-- Bootstrap & Icons -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <!-- Custom Font -->
    <link
      href="https://fonts.googleapis.com/css2?family=Do+Hyeon&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Do Hyeon", sans-serif;
        background-color: #f5f9f5;
      }

      .cart-card {
        background-color: white;
        border: 1px solid #e0e0e0;
        border-radius: 1rem;
        padding: 2rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      }

      .cart-item {
        border-bottom: 1px solid #ddd;
        padding: 1rem 0;
      }

      .cart-item:last-child {
        border-bottom: none;
      }

      .cart-title {
        color: #228b22;
        margin-bottom: 1.5rem;
      }

      .total-row {
        font-weight: bold;
        font-size: 1.1rem;
        border-top: 2px solid #ccc;
        padding-top: 1rem;
      }

      .btn-checkout {
        background-color: #228b22;
        color: white;
      }

      .btn-checkout:hover {
        background-color: #1e7a1e;
      }
    </style>
  </head>
  <body>
    <!-- ğŸ”¹ ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light px-4">
      <a class="navbar-brand" href="index.html">Bonanza</a>
      <div class="ms-auto d-flex align-items-center gap-3">
        <!-- ì¥ë°”êµ¬ë‹ˆ ë²„íŠ¼ -->
        <a href="cart.html" class="btn btn-outline-dark position-relative">
          <i class="bi-cart-fill me-1"></i>
          ì¥ë°”êµ¬ë‹ˆ
          <span
            id="cart-count"
            class="badge bg-dark text-white ms-1 rounded-pill"
            >0</span
          >
        </a>

        <!-- ë¡œê·¸ì¸ ì˜ì—­ (ë”± í•˜ë‚˜ë§Œ!) -->
        <div id="login-form" class="text-end p-3">
          <input
            type="text"
            id="login-id"
            placeholder="ì•„ì´ë””"
            class="form-control d-inline w-auto me-2"
          />
          <input
            type="password"
            id="login-pw"
            placeholder="ë¹„ë°€ë²ˆí˜¸"
            class="form-control d-inline w-auto me-2"
          />
          <button id="login-btn" class="btn btn-success btn-sm">ë¡œê·¸ì¸</button>
        </div>

        <!-- ë¡œê·¸ì¸ í›„ ì˜ì—­ -->
        <div id="user-area" class="text-end p-3" style="display: none">
          <span><strong id="user-name"></strong></span>
          <span id="subscription-status" class="badge bg-success small"></span>
          <button id="logout-btn" class="btn btn-secondary btn-sm ms-2">
            ë¡œê·¸ì•„ì›ƒ
          </button>
        </div>
      </div>
    </nav>

    <!-- ì¥ë°”êµ¬ë‹ˆ ì½˜í…ì¸  -->
    <div class="container my-5">
      <div class="cart-card">
        <h2 class="cart-title">ğŸ›’ ë‚˜ì˜ ì¥ë°”êµ¬ë‹ˆ</h2>

        <div id="cart-items-container">
          <!-- ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆ ëª©ë¡ì´ ì—¬ê¸°ì— ë Œë”ë§ë¨ -->
        </div>

        <div class="total-row d-flex justify-content-between mt-4">
          <span>ì´ í•©ê³„</span>
          <span id="total-price">â‚©0</span>
        </div>

        <div class="d-flex gap-2 mt-4">
          <a href="index.html" class="btn btn-outline-secondary w-50"
            >â† ê³„ì† ì‡¼í•‘í•˜ê¸°</a
          >
          <button id="clear-cart" class="btn btn-danger w-50">
            ì¥ë°”êµ¬ë‹ˆ ë¹„ìš°ê¸°
          </button>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const container = document.getElementById("cart-items-container");
        const totalPriceEl = document.getElementById("total-price");
        const clearBtn = document.getElementById("clear-cart");
        const cartCount = document.getElementById("cart-count");

        const loginForm = document.getElementById("login-form");
        const loginId = document.getElementById("login-id");
        const loginPw = document.getElementById("login-pw");
        const loginBtn = document.getElementById("login-btn");
        const subscriptionStatus = document.getElementById(
          "subscription-status"
        );

        const userArea = document.getElementById("user-area");
        const userName = document.getElementById("user-name");
        const logoutBtn = document.getElementById("logout-btn");

        // ë¡œê·¸ì¸ ìƒíƒœ ê°±ì‹ 
        function updateLoginUI() {
          const isLogin = localStorage.getItem("isLogin") === "true";
          const username = localStorage.getItem("username");
          const isSubscriber = localStorage.getItem("isSubscriber") === "true";

          // ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ ì˜ì—­
          if (userArea && userName && subscriptionStatus) {
            if (isLogin && username) {
              if (loginForm) loginForm.style.display = "none";
              userArea.style.display = "block";

              if (username === "admin") {
                userName.textContent = "ê´€ë¦¬ì ëª¨ë“œì…ë‹ˆë‹¤.";
                subscriptionStatus.textContent = ""; // ê´€ë¦¬ìì´ë¯€ë¡œ êµ¬ë… í‘œì‹œ ì—†ìŒ
                subscriptionStatus.style.display = "none";
              } else {
                userName.textContent = `VIP ${username} ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤!`;
                subscriptionStatus.textContent = isSubscriber
                  ? "âœ… êµ¬ë…ì¤‘"
                  : "";
                subscriptionStatus.style.display = "inline";
              }
            } else {
              if (loginForm) loginForm.style.display = "block";
              userArea.style.display = "none";
            }
          }
        }

        loginBtn.addEventListener("click", () => {
          const id = loginId.value.trim();
          const pw = loginPw.value.trim();

          if (
            (id === "admin" && pw === "123") ||
            (id === "123" && pw === "123")
          ) {
            localStorage.setItem("isLogin", "true");
            localStorage.setItem("username", id);
            localStorage.setItem("isAdmin", id === "admin" ? "true" : "false");
            updateLoginUI();
          } else {
            alert("ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.");
          }
        });

        logoutBtn.addEventListener("click", () => {
          localStorage.clear();
          updateLoginUI();
        });

        updateLoginUI();

        // ì¥ë°”êµ¬ë‹ˆ í‘œì‹œ
        const cart = JSON.parse(localStorage.getItem("cart")) || [];
        cartCount.textContent = cart.length;

        if (cart.length === 0) {
          container.innerHTML =
            "<p class='text-muted'>ì¥ë°”êµ¬ë‹ˆê°€ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.</p>";
          totalPriceEl.textContent = "â‚©0";
          clearBtn.disabled = true;
          return;
        }

        let total = 0;
        let html = "";
        cart.forEach((item) => {
          total += parseInt(item.price);
          html += `
            <div class="cart-item d-flex justify-content-between align-items-center">
              <div>
                <strong>${item.name}</strong><br />
                <small class="text-muted">${Number(
                  item.price
                ).toLocaleString()}ì›</small>
              </div>
              <i class="bi bi-bag"></i>
            </div>
          `;
        });

        container.innerHTML = html;
        totalPriceEl.textContent = `${total.toLocaleString()}ì›`;

        clearBtn.addEventListener("click", function () {
          if (confirm("ì¥ë°”êµ¬ë‹ˆë¥¼ ë¹„ìš°ì‹œê² ìŠµë‹ˆê¹Œ?")) {
            localStorage.removeItem("cart");
            location.reload();
          }
        });
      });
    </script>
  </body>
</html>
